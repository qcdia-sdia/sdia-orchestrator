openapi: 3.0.0
info:
  title: sdia-orchestrator
  description: Software Defined Infrastructure Automator orchestrator. Orchestrator
    for TOSCA workflows. Deploys, manages at runtime or undeploys a TOSCA topology
    of declarative workflows and imperative workflows. Generates declarative workflows
    which are automatically generated by the orchestrator based on nodes, relationships,
    and groups defined in the topology. The Orchestrator also executes imperative
    workflows which are manually specified.
  contact:
    email: S.Koulouzis@uva.nl
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  version: 1.0.0
servers:
- url: /sdia-orchestrator/1.0.0
security:
- oAuth:
  - read
  - modify
paths:
  /tosca_template:
    post:
      summary: upload a tosca template description file
      description: uploads and validates TOSCA template file
      operationId: uploadToscaTemplate
      requestBody:
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/body'
      responses:
        "200":
          description: successful operation
          content:
            '*/*':
              schema:
                type: string
        "405":
          description: Invalid input
  /tosca_template/ids:
    get:
      summary: Get all topolog template IDs
      description: Returns all IDs
      operationId: getToscaTemplateIDs
      responses:
        "200":
          description: successful operation
          content:
            application/json:
              schema:
                type: array
                items:
                  type: string
        "400":
          description: Invalid ID supplied
        "404":
          description: ToscaTemplate not found
        "405":
          description: Invalid input
  /tosca_template/{id}:
    get:
      summary: Find topolog template by ID
      description: Returns a single topolog template
      operationId: getToscaTemplateByID
      parameters:
      - name: id
        in: path
        description: ID of topolog template to return
        required: true
        style: simple
        explode: false
        schema:
          type: string
      - name: filter
        in: query
        description: the filters to use for finding tosca templates
        required: false
        style: form
        explode: true
        schema:
          type: object
          additionalProperties:
            type: string
      responses:
        "200":
          description: successful operation
          content:
            json/application:
              schema:
                $ref: '#/components/schemas/ToscaTemplate'
        "400":
          description: Invalid ID supplied
        "404":
          description: ToscaTemplate not found
        "405":
          description: Invalid input
    put:
      summary: Updates exisintg topolog template
      operationId: updateToscaTemplateByID
      parameters:
      - name: id
        in: path
        description: ID of topolog template to return
        required: true
        style: simple
        explode: false
        schema:
          type: string
      requestBody:
        content:
          multipart/form-data:
            schema:
              $ref: '#/components/schemas/body_1'
      responses:
        "200":
          description: successful operation
          content:
            text/plain:
              schema:
                type: string
        "400":
          description: Invalid ID supplied
        "404":
          description: ToscaTemplate not found
        "405":
          description: Invalid input
    delete:
      summary: Deletes a tosca topology template
      description: If the topology is provisoned it will delete the provison (Infrastructure).
        If it is deployed it will delete the deploymet too (Application)
      operationId: deleteToscaTemplateByID
      parameters:
      - name: id
        in: path
        description: ID of topology template to return
        required: true
        style: simple
        explode: false
        schema:
          type: string
      - name: node_names
        in: query
        description: The node(s) to delete
        required: false
        style: form
        explode: true
        schema:
          type: array
          items:
            type: string
      responses:
        "200":
          description: successful operation
          content:
            json/application:
              schema:
                type: string
        "400":
          description: Invalid ID supplied
        "404":
          description: ToscaTemplate not found
  /tosca_template/{id}/plan:
    get:
      summary: generate a plan for this topolog template by ID
      description: Returns  the ID of the planned topolog template
      operationId: getPlan
      parameters:
      - name: id
        in: path
        description: ID of topolog template
        required: true
        style: simple
        explode: false
        schema:
          type: string
      responses:
        "200":
          description: successful operation
          content:
            json/application:
              schema:
                type: string
        "400":
          description: Invalid ID supplied
        "404":
          description: ToscaTemplate not found
        "405":
          description: Invalid input
  /tosca_template/{id}/workflow:
    get:
      summary: generate a workflow for this topolog template by ID
      description: Returns  the ID of the topolog template with the added workflow
      operationId: getWorkflow
      parameters:
      - name: id
        in: path
        description: ID of topolog template
        required: true
        style: simple
        explode: false
        schema:
          type: string
      responses:
        "200":
          description: successful operation
          content:
            text/plain:
              schema:
                type: string
        "400":
          description: Invalid ID supplied
        "404":
          description: ToscaTemplate not found
        "405":
          description: Invalid input
  /tosca_template/{id}/workflow/execute:
    get:
      summary: execute a workflow for this topolog template by ID
      description: Returns  the ID of the topolog template with the added workflow
      operationId: executeWorkflow
      parameters:
      - name: id
        in: path
        description: ID of topolog template
        required: true
        style: simple
        explode: false
        schema:
          type: string
      responses:
        "200":
          description: successful operation
          content:
            text/plain:
              schema:
                type: string
        "400":
          description: Invalid ID supplied
        "404":
          description: ToscaTemplate not found
        "405":
          description: Invalid input
components:
  schemas:
    Credential:
      type: object
    NodeTemplate:
      type: object
    TopologyTemplate:
      type: object
    ToscaTemplate:
      type: object
    NodeTemplateMap:
      type: object
    body:
      required:
      - file
      type: object
      properties:
        file:
          type: string
          description: tosca Template description
          format: binary
    body_1:
      type: object
      properties:
        file:
          type: string
          description: tosca Template description
          format: binary
  securitySchemes:
    oAuth:
      type: oauth2
      description: This API uses OAuth 2 with the implicit grant flow.
      flows:
        implicit:
          authorizationUrl: /oauth2/authorize
          scopes:
            read_tosca: read
            write_tosca: modify
